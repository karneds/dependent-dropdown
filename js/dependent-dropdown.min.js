/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2013 - 2016
 * http://plugins.krajee.com/dependent-dropdown
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD 3-Clause
 * https://github.com/kartik-v/dependent-dropdown/blob/master/LICENSE.md
 */!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";e.fn.depdropLocales={};var t,a,n,d;t=function(t,a){return null===t||void 0===t||0===t.length||a&&""===e.trim(t)},a=function(t,a,n,d,o){var i={value:a,text:n};o=o||{},i=e.extend(i,o),null!==d&&d.length&&-1!==d.indexOf(a.toString())&&(i.selected="selected"),e("<option/>",i).appendTo(t)},n=function(t,a){var n={};return 0===t.length?{}:(e.each(t,function(e,t){n[t]=a[e]}),n)},d=function(t,a){var n=this;n.$element=e(t),e.each(a,function(e,t){n[e]=t}),n.initData(),n.init()},d.prototype={constructor:d,initData:function(){var e=this,t=e.$element;e.initVal=t.val(),t.data("url",e.url).data("placeholder",e.placeholder).data("loading",e.loading).data("loadingClass",e.loadingClass).data("loadingText",e.loadingText).data("emptyMsg",e.emptyMsg).data("params",e.params)},init:function(){var t,a=this,n=a.depends,d=a.$element,o=n.length,i=d.find("option").length,r=a.initDepends||a.depends;for((0===i||d.find('option[value=""]').length===i)&&d.attr("disabled","disabled"),t=0;o>t;t++)a.listen(t,n,o);if(a.initialize===!0)for(t=0;t<r.length;t++)e("#"+r[t]).trigger("depdrop.change");d.trigger("depdrop.init")},listen:function(a,n,d){var o=this;e("#"+n[a]).on("depdrop.change change select2:select krajeeselect2:cleared",function(a){var i=e(this);(t(i.data("select2"))||"change"!==a.type)&&o.setDep(i,n,d)})},setDep:function(t,a,n){for(var d,o,i=this,r=i.$element,l={},p=0;n>p;p++)d=e("#"+a[p]),o=d.attr("type"),l[p]="checkbox"===o||"radio"===o?d.prop("checked"):d.val();i.processDep(r,t.attr("id"),l,a)},processDep:function(d,o,i,r){var l,p,s,c,u,f=this,g=0,h={},m={},v=d.data("url"),y=n(r,i),x={},b=d.data("placeholder"),P=d.data("loading"),j=d.data("loadingClass"),C=d.data("loadingText"),D=d.data("emptyMsg"),S=d.data("params");if(m[f.parentParam]=i,!t(S)){for(s=0;s<S.length;s++)c=S[s],u=e("#"+S[s]).val(),h[s]=u,x[c]=u;m[f.otherParam]=h}m[f.allParam]=e.extend(y,x),p={url:v,type:"post",data:m,dataType:"json",beforeSend:function(){d.trigger("depdrop.beforeChange",[o,e("#"+o).val(),f.initVal]),d.find("option[selected]").removeAttr("selected"),d.val("").attr("disabled","disabled").html(""),P&&d.removeClass(j).addClass(j).html('<option id="">'+C+"</option>")},success:function(n){l=t(n.selected)?f.initVal===!1?null:f.initVal:n.selected,"string"==typeof l&&(l=l.split()),t(n)?a(d,"",D,""):(d.html(f.getSelect(n.output,b,l)),d.find("optgroup").length>0&&d.find('option[value=""]').attr("disabled","disabled"),n.output&&d.removeAttr("disabled")),g=d.find("option").length,d.find('option[value=""]').length>0&&(g-=1),d.trigger("depdrop.change",[o,e("#"+o).val(),g,f.initVal])},error:function(){d.trigger("depdrop.error",[o,e("#"+o).val(),f.initVal])},complete:function(){P&&d.removeClass(j),d.trigger("depdrop.afterChange",[o,e("#"+o).val(),f.initVal])}},p=e.extend(p,f.ajaxSettings),e.ajax(p)},getSelect:function(n,d,o){var i,r=this,l=e("<select>"),p=r.idParam,s=r.nameParam;return d!==!1&&a(l,"",d,o),t(n)&&(n={}),e.each(n,function(t,n){if(n[p])i=n[r.optionsParam]||{},a(l,n[p],n[s],o,i);else{var d=e("<optgroup>",{label:t});e.each(n,function(e,t){i=t[r.optionsParam]||{},a(d,t[p],t[s],o,i)}),d.appendTo(l)}}),l.html()}},e.fn.depdrop=function(a){var n=Array.apply(null,arguments),o=[];switch(n.shift(),this.each(function(){var i=e(this),r=i.data("depdrop"),l="object"==typeof a&&a,p=l.language||i.data("language")||"en",s=e.fn.depdrop.defaults;r||("en"===p||t(e.fn.depdropLocales[p])||e.extend(s,e.fn.depdropLocales[p]),r=new d(this,e.extend(s,l,i.data())),i.data("depdrop",r)),"string"==typeof a&&o.push(r[a].apply(r,n))}),o.length){case 0:return this;case 1:return o[0];default:return o}},e.fn.depdrop.defaults={language:"en",url:"",depends:"",initDepends:"",loading:!0,loadingClass:"kv-loading",initialize:!1,idParam:"id",nameParam:"name",optionsParam:"options",parentParam:"depdrop_parents",otherParam:"depdrop_params",allParam:"depdrop_all_params",params:{},ajaxSettings:{}},e.fn.depdropLocales.en={loadingText:"Loading ...",placeholder:"Select ...",emptyMsg:"No data found"},e.extend(e.fn.depdrop.defaults,e.fn.depdropLocales.en),e.fn.depdrop.Constructor=d,e(function(){e("select.depdrop").depdrop()})});